<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Song4U ‚Äî Lightweight Music Player</title>
  <style>
    :root{
      --bg:#06070a; --card:#0f1114; --accent:#00ffd5; --muted:#9aa3ad;
      --glass: rgba(255,255,255,0.03);
      font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    }
    *{box-sizing:border-box}
    body{margin:0;min-height:100vh;background:linear-gradient(180deg,#04050a 0%, #08101a 100%);color:#e6f3f2;display:flex;align-items:center;justify-content:center;padding:24px}
    .container{width:980px;max-width:98%;display:grid;grid-template-columns:320px 1fr;gap:20px}

    /* left: playlist */
    .sidebar{background:linear-gradient(180deg, rgba(255,255,255,0.02), transparent);border-radius:14px;padding:16px;box-shadow:0 6px 24px rgba(0,0,0,0.6)}
    .header{display:flex;align-items:center;gap:12px}
    .logo{width:46px;height:46px;border-radius:10px;background:linear-gradient(135deg,var(--accent),#8b5cf6);display:flex;align-items:center;justify-content:center;font-weight:700;color:#041018}
    h1{font-size:16px;margin:0}
    .search{margin-top:12px}
    #searchSongs{width:100%;padding:8px 10px;border-radius:8px;border:1px solid rgba(255,255,255,0.04);background:transparent;color:inherit}
    ul#songListItems{list-style:none;padding:8px 0;margin:12px 0;max-height:62vh;overflow:auto}
    ul#songListItems li{padding:10px;border-radius:8px;margin-bottom:6px;cursor:pointer;color:var(--muted);display:flex;align-items:center;justify-content:space-between}
    ul#songListItems li:hover{background:var(--glass);color:var(--accent)}
    ul#songListItems li.playing{background:linear-gradient(90deg, rgba(0,255,213,0.06), rgba(139,92,246,0.04));color:var(--accent);font-weight:600}
    .waveform{display:inline-flex;gap:3px;margin-left:8px}
    .waveform span{display:inline-block;width:3px;height:10px;background:linear-gradient(180deg,var(--accent),#8b5cf6);border-radius:2px;animation:wave 800ms infinite}
    .waveform span:nth-child(2){animation-delay:120ms}
    .waveform span:nth-child(3){animation-delay:240ms}
    @keyframes wave{0%{transform:scaleY(.6)}50%{transform:scaleY(1.7)}100%{transform:scaleY(.6)}}

    /* player */
    .player{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));padding:20px;border-radius:14px;display:flex;flex-direction:column;gap:14px}
    .now{display:flex;gap:14px;align-items:center}
    #thumbnail{width:140px;height:140px;border-radius:12px;object-fit:cover;background:#0b0f12}
    .meta{flex:1}
    #songName{font-size:20px;margin:0 0 6px 0;color:var(--accent)}
    .controls{display:flex;align-items:center;gap:10px}
    .btn{background:transparent;border:1px solid rgba(255,255,255,0.06);padding:8px;border-radius:10px;cursor:pointer}
    .big{padding:12px 16px;font-size:18px}
    #timeline{width:100%;appearance:none;height:6px;border-radius:6px;background:linear-gradient(90deg,#2b2f35, #111)}
    .time{display:flex;justify-content:space-between;font-size:13px;color:var(--muted)}
    .misc{display:flex;gap:8px;align-items:center}
    #loading{position:absolute;inset:0;display:none;align-items:center;justify-content:center}

    /* responsive */
    @media (max-width:820px){.container{grid-template-columns:1fr;grid-auto-rows:auto}.sidebar{order:2}}
  </style>
</head>
<body>
  <div class="container">
    <aside class="sidebar" id="songList">
      <div class="header">
        <div class="logo">SF</div>
        <div>
          <h1>Song4U</h1>
          <div style="font-size:12px;color:var(--muted)">Lightweight web player</div>
        </div>
      </div>
      <!-- Search & list will be filled by JS -->
    </aside>

    <main class="player">
      <div style="position:relative">
        <div id="loading">Loading...</div>
        <div class="now">
          <img id="thumbnail" src="" alt="thumb">
          <div class="meta">
            <h2 id="songName">Loading...</h2>
            <div class="controls">
              <button id="prevBtn" class="btn">‚èÆ</button>
              <button id="playBtn" class="btn big">‚ñ∂</button>
              <button id="pauseBtn" class="btn big">‚ñÆ‚ñÆ</button>
              <button id="nextBtn" class="btn">‚è≠</button>
              <div style="flex:1"></div>
              <button id="menuToggle" class="btn">‚ò∞</button>
            </div>
            <div style="margin-top:12px">
              <input id="timeline" type="range" min="0" value="0">
              <div class="time"><span id="currentTime">0:00</span><span id="duration">0:00</span></div>
            </div>
          </div>
        </div>

        <audio id="audio"></audio>
      </div>

      <div style="display:flex;justify-content:space-between;align-items:center">
        <div style="font-size:13px;color:var(--muted)">Tip: Right-click is disabled</div>
        <div class="misc">üîä <span style="color:var(--muted);font-size:13px">Random start</span></div>
      </div>
    </main>
  </div>

  <script type="module">
// ---------- playlist (content of audiodb.js merged here) ----------
export const playlist = [
  {name: "Mr.Kitty - After Dark", src: "https://files.catbox.moe/55z0xp.mp3", thumb: "https://files.catbox.moe/71l6k7.jpg"},
  {name: "Ranam Title Track | Lyric Video | Prithviraj Sukumaran", src: "https://files.catbox.moe/t4rztg.mp3", thumb: "https://files.catbox.moe/wfyzab.jpg"},
  {name: "I Wanna Be Yours", src: "https://files.catbox.moe/59ursd.mp3", thumb: "https://files.catbox.moe/4tr6ip.jpg"},
  {name: "Avicii - The Nights", src: "https://files.catbox.moe/by3cbr.mp3", thumb: "https://files.catbox.moe/1dmv8w.jpg"},
  {name: "Madonna - Like A Prayer", src: "https://files.catbox.moe/x19j3y.mp3", thumb: "https://files.catbox.moe/9g9hks.jpg"},
  {name: "Lady Gaga, Bruno Mars - Die With A Smile (Official Music Video)", src: "https://files.catbox.moe/8ejjkm.m4a", thumb: "https://files.catbox.moe/3y3yny.jpg"},
  {name: "Alan Walker & Ava Max - Alone, Pt. II", src: "https://files.catbox.moe/70gs6c.mp3", thumb: "https://files.catbox.moe/du5ajv.jpg"},
  {name: "Coldplay - Hymn For The Weekend (Official Video)", src: "https://files.catbox.moe/4mppob.mp3", thumb: "https://files.catbox.moe/mbbo9s.jpg"},
  {name: "Lana Del Rey - Summertime Sadness (Official Music Video)", src: "https://files.catbox.moe/mdvomq.mp3", thumb: "https://files.catbox.moe/zqeru9.jpg"},
  {name: "The Weeknd - Blinding Lights (Official Video)", src: "https://files.catbox.moe/6o4jvf.mp3", thumb: "https://files.catbox.moe/fr99qo.jpg"},
  {name: "Ghost - Mary On A Cross (Official Music Video)", src: "https://files.catbox.moe/4pgicv.mp3", thumb: "https://files.catbox.moe/aoua4f.jpg"},
  {name: "IN THE END (Slowed Down) - Tommee Profitt, Fleurie [Mellen Gi Remix]", src: "https://files.catbox.moe/zpas8g.mp3", thumb: "https://files.catbox.moe/nyywky.jpg"},
  {name: " VXLLAIN, V√òJ, Narvent - Distant Echoes (4K Official Music Video)", src: "https://files.catbox.moe/gmq4jd.mp3", thumb: "https://files.catbox.moe/uw25ar.jpg"},
  {name: "V√òJ, Narvent - Memory Reboot (4K Music Video)", src: "https://files.catbox.moe/09w2su.mp3", thumb: "https://files.catbox.moe/bm2fq0.jpg"},
  {name: "Post Malone, Swae Lee - Sunflower", src: "https://files.catbox.moe/512la6.mp3", thumb: "https://files.catbox.moe/8xfbq1.jpg"},
  {name: "Narvent - Fainted", src: "https://files.catbox.moe/gme3ud.mp3", thumb: "https://files.catbox.moe/weul01.jpg"},
  {name: "K-391 & Alan Walker - Ignite (feat. Julie Bergan & Seungri)", src: "https://files.catbox.moe/qsons4.mp3", thumb: "https://files.catbox.moe/k23ytz.jpg"}
];

// ---------- main player script (adapted from your code) ----------
const audio = document.getElementById('audio');
const playBtn = document.getElementById('playBtn');
const pauseBtn = document.getElementById('pauseBtn');
const timeline = document.getElementById('timeline');
const currentTimeDisplay = document.getElementById('currentTime');
const durationDisplay = document.getElementById('duration');
const prevBtn = document.getElementById('prevBtn');
const nextBtn = document.getElementById('nextBtn');
const thumbnail = document.getElementById('thumbnail');
const songName = document.getElementById('songName');
const loading = document.getElementById('loading');
const songListContainer = document.getElementById('songList');
const menuToggle = document.getElementById('menuToggle');

let currentTrack = Math.floor(Math.random() * playlist.length);

function loadTrack(index) {
    if (!audio || !thumbnail || !songName || !loading) return;
    loading.style.display = 'flex';
    currentTrack = index;
    audio.src = playlist[currentTrack].src;
    thumbnail.src = playlist[currentTrack].thumb;
    songName.textContent = playlist[currentTrack].name;
    audio.load();
    audio.addEventListener('canplaythrough', () => {
        if (loading) loading.style.display = 'none';
        updatePlayingIndicator(); 
    }, { once: true });
}

if (playBtn && pauseBtn && audio) {
    playBtn.style.display = 'inline-block';
    pauseBtn.style.display = 'none';

    playBtn.addEventListener('click', () => {
      audio.play().catch(error => {
        console.error('Autoplay failed:', error);
      });
      playBtn.style.display = 'none';
      pauseBtn.style.display = 'inline-block';
    });

    pauseBtn.addEventListener('click', () => {
      audio.pause();
      pauseBtn.style.display = 'none';
      playBtn.style.display = 'inline-block';
    });

    audio.addEventListener('ended', () => {
      currentTrack = (currentTrack + 1) % playlist.length; 
      loadTrack(currentTrack); 
      audio.play().catch(error => {
        console.error('Autoplay failed on ended:', error);
      });
       if (playBtn && pauseBtn) {
        playBtn.style.display = 'none';
        pauseBtn.style.display = 'inline-block';
      }
    });
}

if (audio && timeline && durationDisplay && currentTimeDisplay) {
    audio.addEventListener('loadedmetadata', () => {
      timeline.max = Math.floor(audio.duration);
      durationDisplay.textContent = formatTime(audio.duration);
    });

    audio.addEventListener('timeupdate', () => {
      timeline.value = Math.floor(audio.currentTime);
      currentTimeDisplay.textContent = formatTime(audio.currentTime);
    });

    timeline.addEventListener('input', () => {
      audio.currentTime = timeline.value;
    });
}

if (nextBtn && audio && playBtn && pauseBtn) {
    nextBtn.addEventListener('click', () => {
      currentTrack = (currentTrack + 1) % playlist.length; 
      loadTrack(currentTrack); 
      audio.play().then(() => {
        if (playBtn && pauseBtn) {
            playBtn.style.display = 'none';
            pauseBtn.style.display = 'inline-block';
        }
      }).catch(error => {
        console.error('Autoplay failed on next:', error);
      });
    });
}

if (prevBtn && audio && playBtn && pauseBtn) {
    prevBtn.addEventListener('click', () => {
      currentTrack = (currentTrack - 1 + playlist.length) % playlist.length; 
      loadTrack(currentTrack); 
      audio.play().then(() => {
        if (playBtn && pauseBtn) {
            playBtn.style.display = 'none';
            pauseBtn.style.display = 'inline-block';
        }
      }).catch(error => {
        console.error('Autoplay failed on prev:', error);
      });
    });
}

function formatTime(seconds) {
  const min = Math.floor(seconds / 60);
  const sec = Math.floor(seconds % 60).toString().padStart(2, '0');
  return `${min}:${sec}`;
}

function updatePlayingIndicator() {
    const songListItems = document.querySelectorAll('#songListItems li');
    songListItems.forEach((li) => {
        li.classList.remove('playing');
        const existingWaveform = li.querySelector('.waveform');
        if (existingWaveform) {
            existingWaveform.remove();
        }
    });

    const currentItem = document.querySelector(`#songListItems li[data-index="${currentTrack}"]`);
    if (currentItem) {
        currentItem.classList.add('playing');
        const waveform = document.createElement('div');
        waveform.classList.add('waveform');
        for (let i = 0; i < 3; i++) {
            const bar = document.createElement('span');
            waveform.appendChild(bar);
        }
        currentItem.appendChild(waveform);
    }
}

loadTrack(currentTrack);

// disable inspect-ish actions (you provided this)
document.addEventListener('contextmenu', (e) => e.preventDefault());
document.addEventListener('keydown', (e) => {
  if (e.ctrlKey && ['u', 's', 'c', 'p'].includes(e.key.toLowerCase())) {
    e.preventDefault();
  }
  if (e.ctrlKey && e.shiftKey && ['i', 'j'].includes(e.key.toLowerCase())) {
    e.preventDefault();
  }
  if (e.key === 'F12') {
    e.preventDefault();
  }
});

function populateSongList() {
    if (!songListContainer) return;

    const searchBox = document.createElement('input');
    searchBox.type = 'text';
    searchBox.placeholder = 'Search songs...';
    searchBox.id = 'searchSongs';

    const ul = document.createElement('ul');
    ul.id = 'songListItems';

    playlist.forEach((track, index) => {
        const li = document.createElement('li');
        li.textContent = track.name;
        li.dataset.index = index.toString();
        li.addEventListener('click', () => {
            loadTrack(index);
            if (songListContainer) {
                songListContainer.classList.add('hidden');
                if (menuToggle) menuToggle.style.display = 'block';
            }
            if (audio && playBtn && pauseBtn) {
                audio.play().then(() => {
                    playBtn.style.display = 'none';
                    pauseBtn.style.display = 'inline-block';
                }).catch(error => {
                    console.error('Autoplay failed on list click:', error);
                });
            }
        });
        ul.appendChild(li);
    });

    songListContainer.innerHTML = '<h3 style="color: var(--accent);">All Songs</h3>';
    songListContainer.appendChild(searchBox);
    songListContainer.appendChild(ul);

    searchBox.addEventListener('input', () => {
        const filter = searchBox.value.toLowerCase();
        document.querySelectorAll('#songListItems li').forEach(li => {
            const trackName = li.textContent || "";
            li.style.display = trackName.toLowerCase().includes(filter) ? 'block' : 'none';
        });
    });
}

if (menuToggle && songListContainer) {
    menuToggle.addEventListener('click', () => {
        songListContainer.classList.toggle('hidden');
        if (songListContainer.classList.contains('hidden')) {
            menuToggle.style.display = 'block';
        } else {
            menuToggle.style.display = 'none';
        }
    });
}

populateSongList();
updatePlayingIndicator();

document.addEventListener('click', (event) => {
  if (!songListContainer || !menuToggle) return; 

  const targetElement = event.target;
  const isClickInsideList = songListContainer.contains(targetElement);
  const isClickOnToggle = menuToggle.contains(targetElement);

  if (!isClickInsideList && !isClickOnToggle) {
      if (!songListContainer.classList.contains('hidden')) {
          songListContainer.classList.add('hidden');
          menuToggle.style.display = 'block';
      }
  }
});

  </script>
</body>
</html>
